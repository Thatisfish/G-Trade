import{g as U,u as E,a as O,j as r,N as M,r as d,H as k,S as X,h as $,i as A}from"./react-vendor-CToDt6bN.js";import{A as G,P as H,N as D}from"./swiper-N-f5SBSU.js";import{P as F,A as V}from"./index-MPD8Ytfp.js";import{P as Y}from"./Pagination-BuKMzhB5.js";import"./vendor-DLEfv8Se.js";const q=""+new URL("banner_pokemon-vfmWkoXl.avif",import.meta.url).href,z=""+new URL("Alltype_banner02-D2iXLrGG.avif",import.meta.url).href,W=""+new URL("Alltype_banner03-BwrycHns.avif",import.meta.url).href,Q=""+new URL("Alltype_PS_banner01-Bc3WwUd5.webp",import.meta.url).href,Z=""+new URL("Alltype_PS_banner02-CxGMZ0Gl.avif",import.meta.url).href,J=""+new URL("Alltype_PS_banner03-B7H7cIoY.avif",import.meta.url).href,K=""+new URL("Alltype_Xbox_banner01-BHQoPPhq.avif",import.meta.url).href,ee=""+new URL("Alltype_Xbox_banner04-DuODmEVd.avif",import.meta.url).href,te={Switch:[q,z,W],PS:[Q,Z,J],Xbox:[K,ee]},h={Switch:"Switch",PS:"PS系列",Xbox:"Xbox"},b=["全部","主機","遊戲","配件"],ae={全部:"all",主機:"console",遊戲:"game",配件:"accessory"},re={all:"全部",console:"主機",game:"遊戲",accessory:"配件"},L=["Switch","PS","Xbox"],ne=["all","console","game","accessory"],se=t=>{var c,i,s,n;return(n=(s=(i=(c=t==null?void 0:t.id)!=null?c:t==null?void 0:t.slug)!=null?i:t==null?void 0:t.productId)!=null?s:t==null?void 0:t.pid)!=null?n:null},oe=t=>{var i,s,n,u,l,m,f;return{id:se(t),image:Array.isArray(t.mainImage)?t.mainImage[0]:t.mainImage,category:t.category,title:t.productTitle,seller:t.sellerName||"",priceNow:(u=(n=(s=(i=t.salePrice)!=null?i:t.originalPrice)==null?void 0:s.toString)==null?void 0:n.call(s))!=null?u:"",priceOld:t.salePrice!=null?(f=(m=(l=t.originalPrice)==null?void 0:l.toString)==null?void 0:m.call(l))!=null?f:"":void 0,size:"medium"}};function ue(){const{platform:t,category:c}=U(),i=E(),s=O(),n=decodeURIComponent(t||"");if(!L.includes(n))return r.jsx(M,{to:"/alltype/Switch/all",replace:!0});d.useEffect(()=>{c||i(`/alltype/${n}/all`,{replace:!0,state:{noScroll:!0}})},[c,n,i]);const u=ne.includes(c||"")?c:"all",l=re[u]||"全部",m=d.useMemo(()=>{const e=F.filter(o=>o.platform===n).map(oe),a=e.filter(o=>!o.id);return a.length&&console.warn("[AlltypePage] 有商品缺少 id：",a),e.filter(o=>!!o.id)},[n]),f=d.useMemo(()=>m.reduce((e,a)=>(e.全部++,b.includes(a.category)&&(e[a.category]=(e[a.category]||0)+1),e),{全部:0,主機:0,遊戲:0,配件:0}),[m]),y=d.useMemo(()=>l==="全部"?m:m.filter(e=>e.category===l),[m,l]),[S,P]=d.useState(1);d.useEffect(()=>{P(1)},[u,n]);const p=12,_=Math.ceil(y.length/p),v=d.useMemo(()=>{const e=(S-1)*p,a=e+p;return y.slice(e,a)},[y,S]),N=e=>{P(e)},T=e=>{const a=ae[e]||"all";i(`/alltype/${n}/${a}`,{state:{noScroll:!0}})},x=e=>({pathname:`/alltype/${e}/${u}`,state:{noScroll:!0}}),j=te[n]||[],g=L.filter(e=>e!==n),C=(()=>{var a;const e=((a=document.querySelector(".navbar, .site-header"))==null?void 0:a.offsetHeight)||0;return Math.max(80,e+12)})(),R=e=>{if(!e)return;const a=e.replace(/^#/,"");let o=0;const w=()=>{const B=document.getElementById(a);if(B){const I=B.getBoundingClientRect().top+window.scrollY-C;window.scrollTo({top:I,behavior:"smooth"});return}o<20&&(o+=1,setTimeout(w,60))};setTimeout(w,0)};return d.useEffect(()=>{s.hash&&R(s.hash)},[s.key,s.hash]),r.jsxs(r.Fragment,{children:[r.jsxs(k,{children:[r.jsx("title",{children:`遊玩人間市集 ｜ ${h[n]} ｜ ${l}`}),r.jsx("meta",{name:"description",content:"歡迎來到遊玩人間市集，探索各式二手遊戲商品。"})]}),r.jsxs("div",{className:"B_content",children:[r.jsx("div",{className:"B_banner",children:r.jsx(X,{spaceBetween:30,centeredSlides:!0,autoplay:{delay:2500,disableOnInteraction:!1},pagination:{clickable:!0},navigation:!0,modules:[G,H,D],className:"mySwiper",children:j.map((e,a)=>r.jsx($,{children:r.jsx("img",{src:e,alt:"活動橫幅"})},a))})}),r.jsxs("div",{id:"B_itemTitles",className:"B_itemTitles",children:[g[0]&&r.jsx(A,{className:"B_itemTitle",to:x(g[0]),children:h[g[0]]}),r.jsx("p",{className:"B_name",children:h[n]}),g[1]&&r.jsx(A,{className:"B_itemTitle",to:x(g[1]),children:h[g[1]]})]}),r.jsx("div",{className:"B_category",role:"tablist","aria-label":"商品分類 (category 類別)",children:b.map(e=>{var o;const a=l===e;return r.jsxs("button",{className:`B_Categories ${a?"is-active":""}`,type:"button",role:"tab","aria-selected":a,onClick:()=>T(e),children:[e,"（",(o=f[e])!=null?o:0,"）"]},e)})}),r.jsx("div",{id:"B_item",className:"B_item",children:v.map(e=>r.jsx(V,{id:e.id,image:e.image,category:e.category,title:e.title,seller:e.seller,priceNow:e.priceNow,priceOld:e.priceOld,size:"medium",linkTo:`/product/${encodeURIComponent(e.id)}`,wrapperClass:"B_cardLink",ariaLabel:e.title},e.id))}),_>1&&r.jsx(Y,{totalPages:_,onPageChange:N,currentPage:S})]})]})}export{ue as default};
